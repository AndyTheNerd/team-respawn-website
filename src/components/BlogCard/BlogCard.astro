---
import { classNames } from 'webcoreui'
import {
    Card,
    ConditionalWrapper
} from 'webcoreui/astro'

import CloudinaryImage from '../CloudinaryImage.astro'
import type { BlogCardProps } from './blogCard'
import styles from './blog-card.module.scss'

interface Props extends BlogCardProps {}

const {
    href,
    target,
    img,
    title,
    text,
    secondary,
    featured,
    className,
    ...rest
} = Astro.props
---

<a href={href} target={target} class:list={[styles.link, className, featured && styles.featured]}>
    <Card
        {...rest}
        className={styles.card}
        bodyClassName={classNames([styles.body, secondary && styles.secondary])}
        secondary={true}
    >
        <div class={styles.imageContainer}>
            {img.cloudinaryId ? (
                <CloudinaryImage
                    publicId={img.cloudinaryId}
                    alt={img.alt}
                    width={img.width}
                    loading={img.lazy ? 'lazy' : 'eager'}
                    fallbackSrc={img.src}
                    sizes="(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 400px"
                    crop="scale"
                />
            ) : (
                <img
                    src={img.src}
                    alt={img.alt}
                    width={img.width}
                    height={img.height}
                    loading={img.lazy ? 'lazy' : undefined}
                />
            )}
            {featured && (
                <div class={styles.featuredBadge}>
                    <span>‚≠ê Featured</span>
                </div>
            )}
        </div>
        <ConditionalWrapper condition={!!text}>
            <div slot="wrapper">children</div>
            {title && <strong>{title}</strong>}
            {text && <div class="muted" set:html={text} />}
        </ConditionalWrapper>
    </Card>
</a>
